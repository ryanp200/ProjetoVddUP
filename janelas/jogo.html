<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LabMIS</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=menu" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/geral.css"/>
    <link rel="stylesheet" href="../css/textos.css"/>
    <link rel="icon" href="../img/logoTopo.png" />
    <style>
        #opcoes-resposta-container {
            display: flex;
            flex-direction: column;
        }
        #opcoes-resposta-container > button {
            height: 6vh;
            margin-bottom: 10px;
            font-size: 1rem;
        }
        #feedback {
            margin-top: 20px;
            font-size: 1.1rem;
            text-align: center;
        }
        #button-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        #back-button, #next-button, #restart-button {
            display: none;
        }
        .correct {
            background-color: #28a745 !important;
            color: white;
        }
        .incorrect {
            background-color: #dc3545 !important;
            color: white;
        }
        #error-message {
            display: none;
            color: red;
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <img src="../img/logo.png"/>
        <ul>
            <li><a href="../index.html">Início</a></li>
            <li class="dropdown-projeto">
                <span>Projeto</span>
                <ul class="dropdown-projeto-menu">
                    <li onclick="window.location.href='projeto.html'"><a href="projeto.html">Sobre o Projeto</a></li>
                    <li onclick="window.location.href='etec.html'"><a href="etec.html">Etec Santa Isabel</a></li>
                </ul>
            </li>
            <li><a href="jogo.html" style="color:#fff;text-underline-offset: 25%;font-weight: 500;">Jogo</a></li>
            <li><a href="criadores.html">Criadores</a></li>
        </ul>
        <section class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span>Menu</span>
            </button>
            <section class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href="../index.html" onclick="event.preventDefault(); window.location.href='../index.html';">Início</a>
                <a class="dropdown-item" href="projeto.html">Projeto</a>
                <a class="dropdown-item" href="etec.html">Etec Santa Isabel</a>
                <a class="dropdown-item" href="jogo.html">Jogo</a>
                <a class="dropdown-item" href="criadores.html">Criadores</a>
            </section>
        </section>
    </nav>
    <section class="pagina">
        <h3 id="question-text"></h3>
        <section id="opcoes-resposta-container">
            <!-- Botões serão gerados dinamicamente -->
        </section>
        <div id="feedback"></div>
        <div id="error-message">Erro ao carregar o jogo. Verifique sua conexão ou tente novamente.</div>
        <div id="button-container">
            <button id="back-button" class="btn btn-secondary">Voltar</button>
            <button id="next-button" class="btn btn-success">Próxima Pergunta</button>
            <button id="restart-button" class="btn btn-secondary">Nova Rodada</button>
        </div>
        <div id="score">Acertos: 0 / 70</div>
    </section>
    <footer class="rodape">
        <section class="rodape-conteudo">
            <img src="../img/logo.png" alt="Logo LabMIS" class="logo-rodape" />
            <section class="links-rodape">
                <a href="../index.html">Início</a>
                <a href="../janelas/projeto.html">Projeto</a>
                <a href="jogo.html">Jogo</a>
                <a href="criadores.html">Criadores</a>
            </section>
            <p class="creditos">© Projeto VddUP. Todos os direitos reservados.</p>
        </section>
    </footer>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script>
        // Verifica se o jQuery foi carregado
        if (typeof jQuery === 'undefined') {
            document.getElementById('error-message').style.display = 'block';
            throw new Error('jQuery não foi carregado');
        }

        const questions = [
            {
                id: 1,
                question: "Qual é a principal função do alongamento pós-treino?",
                options: ["Evitar lesão", "Melhorar a flexibilidade", "Aumentar a força", "Reduzir o peso"],
                correctAnswer: 1,
                explanation: "A principal função do alongamento pós-treino é melhorar a flexibilidade, ajudando a relaxar os músculos."
            },
            // ... (mantém todas as outras perguntas como no código original)
        ];

        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let userAnswers = [];

        function startRound() {
            currentQuestions = [...questions];
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = Array(currentQuestions.length).fill(null);
            $("#score").text(Acertos: ${score} / ${currentQuestions.length});
            $("#back-button").hide();
            $("#next-button").hide();
            $("#restart-button").hide();
            $("#error-message").hide();
            displayQuestion();
        }

        function displayQuestion() {
            const question = currentQuestions[currentQuestionIndex];
            if (!question) {
                $("#question-text").text("Erro: Nenhuma pergunta encontrada.");
                $("#error-message").show();
                return;
            }

            $("#question-text").text(${currentQuestionIndex + 1}. ${question.question});
            $("#opcoes-resposta-container").empty(); // Limpa botões anteriores

            // Gera botões dinamicamente com base no número de opções
            question.options.forEach((option, index) => {
                const button = $('<button class="btn btn-primary"></button>')
                    .text(option)
                    .click(() => {
                        if (userAnswers[currentQuestionIndex] === null) {
                            checkAnswer(index);
                        }
                    });
                $("#opcoes-resposta-container").append(button);
            });

            $("#feedback").text("");
            $("#opcoes-resposta-container button").removeClass("correct incorrect").prop("disabled", false);

            if (userAnswers[currentQuestionIndex] !== null) {
                const selectedIndex = userAnswers[currentQuestionIndex];
                $("#opcoes-resposta-container button").prop("disabled", true);
                if (selectedIndex === question.correctAnswer) {
                    $("#feedback").html(<span style="color: green;">Correto!</span>);
                    $(#opcoes-resposta-container button:eq(${selectedIndex})).addClass("correct");
                } else {
                    $("#feedback").html(Errado! ${question.explanation}<br><strong>Resposta correta:</strong> ${question.options[question.correctAnswer]});
                    $(#opcoes-resposta-container button:eq(${selectedIndex})).addClass("incorrect");
                    $(#opcoes-resposta-container button:eq(${question.correctAnswer})).addClass("correct");
                }
            }

            $("#back-button").toggle(currentQuestionIndex > 0);
            $("#next-button").toggle(userAnswers[currentQuestionIndex] !== null && currentQuestionIndex < currentQuestions.length - 1);
            $("#restart-button").toggle(currentQuestionIndex === currentQuestions.length - 1 && userAnswers[currentQuestionIndex] !== null);

            console.log(Exibindo pergunta ${currentQuestionIndex + 1}: ${question.question});
        }

        function checkAnswer(selectedIndex) {
            const question = currentQuestions[currentQuestionIndex];
            userAnswers[currentQuestionIndex] = selectedIndex;
            $("#opcoes-resposta-container button").prop("disabled", true);

            if (selectedIndex === question.correctAnswer) {
                score++;
                $("#feedback").html(<span style="color: green;">Correto!</span>);
                $(#opcoes-resposta-container button:eq(${selectedIndex})).addClass("correct");
            } else {
                $("#feedback").html(Errado! ${question.explanation}<br><strong>Resposta correta:</strong> ${question.options[question.correctAnswer]});
                $(#opcoes-resposta-container button:eq(${selectedIndex})).addClass("incorrect");
                $(#opcoes-resposta-container button:eq(${question.correctAnswer})).addClass("correct");
            }

            $("#score").text(Acertos: ${score} / ${currentQuestions.length});
            $("#next-button").toggle(currentQuestionIndex < currentQuestions.length - 1);
            $("#restart-button").toggle(currentQuestionIndex === currentQuestions.length - 1);
        }

        $(document).ready(() => {
            try {
                startRound();
            } catch (e) {
                $("#error-message").show();
                console.error("Erro ao iniciar o jogo:", e);
            }

            $("#next-button").click(() => {
                if (currentQuestionIndex < currentQuestions.length - 1) {
                    currentQuestionIndex++;
                    displayQuestion();
                }
            });

            $("#back-button").click(() => {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    displayQuestion();
                }
            });

            $("#restart-button").click(() => {
                startRound();
            });
        });
    </script>
</body>
</html>
